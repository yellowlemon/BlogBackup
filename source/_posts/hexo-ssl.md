---
title: 'hexo博客之HTTPS访问'
date: 2016-12-13 13:58:20
tags:
  - hexo
---

最近在看微信小程序时发现小程序必须要https的请求才能支持，所以就在查资料时发现了一篇很有趣的文章[《微信小程序之后台https域名绑定以及免费的https证书申请》](http://www.cnblogs.com/likwo/p/6043675.html)

我灵光一现，那能不能把我的bolg也加上https了？？说干就干，申请https的ca证书，还是很方便的，申请一个，半个小时都要不了。
<!--more-->
只需要到阿里云的安全里面，有一个证书服务。

![证书服务](/assets/blogImg/hexo-ssl01.png)

点进去以后，然后购买免费DV SLL云证书就可以了，之后就是域名和一些身份信息的验证，然后你就能拿到你的密匙了。

阿里云这里做的很好，对于不同的服务器都有不同的配置说明，只需要照着配置去修改就可以了。

![证书配置](/assets/blogImg/hexo-ssl02.png)

因为我的服务器配置是nginx，所以我就参照这个阿里云的配置，进行了配置，这里贴一下我的nginx配置。

![nginx配置](/assets/blogImg/hexo-ssl03.png)

在配置https的情况中，遇到了一些问题，这里总结一下

1、80端口访问问题：
```
listen 443 ssl;
ssl on;
```
在把ssl打开后，80端口的访问全部会被nginx拒绝掉，并且抛出一个497错误。

查了资料，可以利用497错误将连接重定向到https的域名，参照我的配置即可。

2、七牛云存储无法访问问题

添加https后，七牛云存储的图片都无法访问了(可以配置https请求，但是这就需要钱了，问题是最缺的就是钱)。没有办法，只有把七牛的博客图片全部都签回自己的云服务器。

3、主题的报错统计反馈无法执行

在yilia中有一段错误统计代码，会将错误反馈给litten大神，也是因为https的限制，导致这个请求无法发送，不得已只有把这段JS代码屏蔽掉了。